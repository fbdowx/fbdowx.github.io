function removeCookie(name) {
  document.cookie = name + '=; Max-Age=-99999999;';
}

function setSelectedLocale(locale) {
  // Remove previous locale cookie
  removeCookie('selectedLocale');

  const intlLocale = new Intl.Locale(locale);
  const langName = new Intl.DisplayNames([locale], { type: "language" }).of(intlLocale.language);
  dropdownContent.innerHTML = "";
  const otherLocales = locales.filter((loc) => loc !== locale);
  otherLocales.forEach((otherLocale) => {
    const otherIntlLocale = new Intl.Locale(otherLocale);
    const otherLangName = new Intl.DisplayNames([otherLocale], { type: "language" }).of(otherIntlLocale.language);
    const region = regionMapping[otherLocale];

    const listEl = document.createElement("li");
    listEl.innerHTML = `${otherLangName}<img src="${getFlagSrc(region)}" />`;
    listEl.value = otherLocale;
    listEl.addEventListener("mousedown", function () {
      setSelectedLocale(otherLocale);
    });
    dropdownContent.appendChild(listEl);
  });
  const region = regionMapping[locale];
  dropdownBtn.innerHTML = `<img src="${getFlagSrc(region)}" />${langName}<span class="arrow-down"></span>`;

  // Save the selected locale in a cookie
  setCookie('selectedLocale', locale, 365);

  // Redirect based on the selected locale
  const currentPath = window.location.pathname;
  const newPath = locale === "en" ? "/" : `/${locale}/`;
  if (currentPath !== newPath) {
    window.location.href = newPath;
  }
}
